<hr>
<script src="https://st.max.ru/js/max-web-app.js"></script>

<script>
  window.onload = function() {
    window.WebApp.requestContact();
    MaxShareFunction();
  }
  function MaxShareFunction() {
    window.WebApp.shareMaxContent({
        text: "test link",
        link: "https://google.com"
      }).then(res => {
      savedkey = JSON.stringify(res);
      document.getElementById("output3").innerHTML = "<h2>shareMaxContent attempt:<br/>" + savedkey + "</h2>";
    }
    ).catch((err)=> {
      document.getElementById("output2").innerHTML = "<h2>shareMaxContent error:<br/>" + err + "</h2>";
    });
  }
  function ShareFunction() {
    window.WebApp.shareContent({
        text: "test link",
        link: "https://google.com"
      }).then(res => {
      savedkey = JSON.stringify(res);
      document.getElementById("output3").innerHTML = "<h2>shareContent attempt:<br/>" + savedkey + "</h2>";
    }
    ).catch((err)=> {
      document.getElementById("output2").innerHTML = "<h2>shareContent error:<br/>" + err + "</h2>";
    });
  }
  function DownloadFileFunction() {
    window.WebApp.downloadFile("https://internetinstitute.ru/file/6/", "test.jpg").then(res => {
      savedkey = JSON.stringify(res);
      document.getElementById("output3").innerHTML = "<h2>downloadFile attempt:<br/>" + savedkey + "</h2>";
    }
    ).catch((err)=> {
      document.getElementById("output2").innerHTML = "<h2>downloadFile error:<br/>" + err + "</h2>";
    });
  }
  function OpenLinkFunction() {
    window.WebApp.openLink("https://google.com").then(res => {
      savedkey = JSON.stringify(res);
      document.getElementById("output3").innerHTML = "<h2>openLink attempt:<br/>" + savedkey + "</h2>";
    }
    ).catch((err)=> {
      document.getElementById("output2").innerHTML = "<h2>openLink error:<br/>" + err + "</h2>";
    });
  }
  function OpenMaxLinkFunction() {
    window.WebApp.openMaxLink("https://max.ru/pupu2").then(res => {
      savedkey = JSON.stringify(res);
      document.getElementById("output3").innerHTML = "<h2>openMaxLink attempt:<br/>" + savedkey + "</h2>";
    }
    ).catch((err)=> {
      document.getElementById("output2").innerHTML = "<h2>openMaxLink error:<br/>" + err + "</h2>";
    });
  }
</script>
<button onclick="MaxShareFunction()">WebAppMaxShare</button>
<button onclick="ShareFunction()">WebAppShare</button>
<button onclick="DownloadFileFunction()">WebAppDownloadFile</button>
<button onclick="OpenLinkFunction()">WebAppOpenLink</button>
<button onclick="OpenMaxLinkFunction()">WebAppOpenMaxLink</button>

<p id="output2" style="display:inline-block;"></p>
<p id="output3" style="display:inline-block;"></p>
<p id="output4" style="display:inline-block;"></p>
<p id="output5" style="display:inline-block;"></p>
<a href="https://hereismypoc.github.io/maxwebapp/malicious.html">click me</a>
<script>
  /*
window.parent.postMessage(
  JSON.stringify({
      "type": "WebAppOpenLink",
      "url": "https://google.com/"
  }),
  "*"
);
window.addEventListener("message", (event2) => {
  console.log("Полученные данные:", event2.data);
  document.getElementById("output2").innerHTML = "<h2>" + event2.data + "</h2>";
});
*/
</script>
